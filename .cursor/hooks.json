{
  "$schema": "https://cursor.sh/schemas/hooks.json",
  "version": 1,
  "hooks": {
    "preToolUse": [
      {
        "matcher": "tool == 'Write' && tool_input.path matches '.*\\.(ts|tsx|js|jsx)$'",
        "command": "echo 'ðŸ“ æé†’ï¼šç¡®ä¿ä»£ç ç¬¦åˆå¯¹åº”çš„ Spec å®šä¹‰' >&2; echo '{\"ok\":true}'"
      },
      {
        "matcher": "tool == 'Bash' && tool_input.command matches '(npm|pnpm|yarn|cargo|pytest|jest).*'",
        "command": "if [ -z \"$TMUX\" ]; then echo '[Hook] å»ºè®®åœ¨ tmux ä¸­è¿è¡Œä»¥ä¾¿ä¼šè¯æŒä¹…åŒ–' >&2; fi; echo '{\"ok\":true}'"
      },
      {
        "matcher": "tool == 'Bash' && tool_input.command matches 'git push.*'",
        "command": "echo 'âš ï¸ å³å°† Push åˆ°è¿œç¨‹ä»“åº“ï¼Œè¯·ç¡®è®¤ä»£ç å·²å®¡æŸ¥é€šè¿‡' >&2; echo '{\"ok\":true}'"
      },
      {
        "matcher": "tool == 'Bash' && tool_input.command matches 'git push.*(main|master).*'",
        "command": "echo 'ðŸš« ç¦æ­¢ç›´æŽ¥ Push åˆ° main/master åˆ†æ”¯ï¼Œè¯·åˆ›å»º PR' >&2; echo '{\"ok\":false,\"blocked\":true,\"reason\":\"push_main_blocked\"}'; exit 2"
      }
    ],
    "postToolUse": [
      {
        "matcher": "tool == 'Write' && tool_input.path matches '.*\\.tsx?$'",
        "command": "npx tsc --noEmit --pretty 2>&1 | head -20 >&2 || true; echo '{\"ok\":true}'"
      },
      {
        "matcher": "tool == 'Write' && tool_input.path matches '.*\\.(ts|tsx|js|jsx|css|json)$'",
        "command": "npx prettier --write \"${TOOL_INPUT_PATH}\" >/dev/null 2>&1 || true; echo '{\"ok\":true}'"
      },
      {
        "matcher": "tool == 'Write' && tool_input.path matches '.*\\.(ts|tsx|js|jsx)$'",
        "command": "if grep -n 'console\\.log' \"${TOOL_INPUT_PATH}\" >/dev/null 2>&1; then echo 'âš ï¸ å‘çŽ° console.logï¼Œè¯·ç§»é™¤æˆ–æ›¿æ¢ä¸º logger' >&2; fi || true; echo '{\"ok\":true}'"
      },
      {
        "matcher": "tool == 'Write' && tool_input.path matches 'src/(api|types)/.*\\.ts$'",
        "command": "echo 'ðŸ“š æé†’ï¼šAPI/ç±»åž‹å®šä¹‰å·²å˜æ›´ï¼Œè®°å¾—è¿è¡Œ /sync åŒæ­¥æ–‡æ¡£' >&2; echo '{\"ok\":true}'"
      },
      {
        "matcher": "tool == 'Write' && tool_input.path matches '.*(auth|payment|admin|security).*'",
        "command": "echo 'ðŸ” å®‰å…¨æ•æ„Ÿæ–‡ä»¶å·²å˜æ›´ï¼Œå»ºè®®è¿è¡Œ /review --security-only' >&2; echo '{\"ok\":true}'"
      }
    ],
    "beforeSubmitPrompt": [
      {
        "matcher": "user_prompt matches '.*(æŠ¥é”™|bug|é”™è¯¯|å¼‚å¸¸|TypeError|Error:).*'",
        "command": "echo 'ðŸ› æ£€æµ‹åˆ°å¯èƒ½æ˜¯ Bug æŽ’æŸ¥ï¼Œå»ºè®®ä½¿ç”¨ @bug-hunter è¿›è¡Œç³»ç»Ÿæ€§æŽ’æŸ¥' >&2; echo '{\"ok\":true}'"
      }
    ],
    "stop": [
      {
        "matcher": "*",
        "command": "echo 'ðŸ“Š æœ¬æ¬¡ä¼šè¯å˜æ›´æ–‡ä»¶:' >&2; git diff --name-only 2>/dev/null | head -10 >&2 || true; echo '{\"ok\":true}'"
      },
      {
        "matcher": "*",
        "command": "if git diff --name-only 2>/dev/null | grep -q 'src/'; then echo 'ðŸ“ æé†’ï¼šä»£ç å·²å˜æ›´ï¼Œä¸‹æ¬¡ä¼šè¯å¼€å§‹æ—¶è¿è¡Œ /sync åŒæ­¥æ–‡æ¡£' >&2; fi || true; echo '{\"ok\":true}'"
      }
    ]
  }
}
